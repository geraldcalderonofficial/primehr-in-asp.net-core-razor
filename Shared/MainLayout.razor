@inherits LayoutComponentBase
@using System.Timers
@using System.Net.Http
@using Microsoft.AspNetCore.Authorization
@using Microsoft.AspNetCore.Components.Authorization
@using Microsoft.AspNetCore.Components.Forms
@using Microsoft.AspNetCore.Components.Routing
@using Microsoft.AspNetCore.Components.Web
@using Microsoft.JSInterop
@using HRMSv4.Shared
@using HRMSv4.Shared.Auth
@using System.Diagnostics
@using HRMSv4.Client.Shared.MainComponents
@inject IJSRuntime _js
@inject NavigationManager nav
@using Microsoft.JSInterop

<link rel="stylesheet" href="_content/Radzen.Blazor/css/default.css" />
<style>
    body {
        overflow: auto;
    }
    .blazored-modal-focus-trap {
        z-index: 102;
    }

    .mainBlockUI {
        flex: 1;
    }

        .mainBlockUI .top-row {
            background-color: #f7f7f7;
            border-bottom: 1px solid #d6d5d5;
            justify-content: flex-end;
        }

            .mainBlockUI .top-row > a, .main .top-row .btn-link {
                white-space: nowrap;
                margin-left: 1.5rem;
            }

            .mainBlockUI .top-row a:first-child {
                overflow: hidden;
                text-overflow: ellipsis;
            }
</style>
<Spinner></Spinner>

<AuthorizeView>
    <Authorized>
            <header>
                <Headerv2/>
            </header>
            <main class="main">
                <AuthorizeView Context="ApplicantItem" Roles="Job Seeker">
                    <div class="nav">
                        <Sidebarv2 />
                    </div>
                    <div class="box-content">
                        <div class="box-heading"></div>
                        <div class="section-box">
                            @Body
                            <RadzenContextMenu />
                        </div>
                        <Footerv2 />
                    </div>
                </AuthorizeView>
                <AuthorizeView Context="AuthorizeItem" Roles="Job Provider, Administrator, Employee">
                <div class="nav">
                    <Sidebarv2 />
                </div>
                <div class="box-content">
                    <div class="box-heading"></div>
                    <div class="section-box">
                            @Body
                            <RadzenContextMenu />
                    </div>
                    <Footerv2 />
                </div>
                </AuthorizeView>
            </main>
    </Authorized>
    <NotAuthorized>
        <div class="main">
            <div class="content px-4">
                @Body
                <RadzenContextMenu />
            </div>
        </div>
    </NotAuthorized>
</AuthorizeView>


@*<BlockUserInterfaceMessage Name="mainBlockUI">
    <div id="test" class="d-flex align-items-center justify-content-center">
        <i class="fa fa-spinner fa-spin fa-3x fa-fw"></i>
        <span class="sr-only">Loading...</span>
    </div>
</BlockUserInterfaceMessage>*@

@code {
    private Timer timerObj;

    //private AppInfo userInfo = new AppInfo();

    protected override async Task OnInitializedAsync()
    {
        //if (firstRender)
        //{
        //    // Set the Timer delay.
        //    timerObj = new Timer(3000);
        //    timerObj.Elapsed += UpdateTimer;
        //    timerObj.AutoReset = false;
        //    // Identify whether the user is active or inactive using onmousemove and onkeypress in JS function.
        //    var dotnetOjbect = DotNetObjectReference.Create(this);
        //    await _js.InvokeVoidAsync("timeOutCall", dotnetOjbect);
        //}
    }

    //[JSInvokable]
    //public void TimerInterval()
    //{
    //    // Resetting the Timer if the user in active state.
    //    timerObj.Stop();
    //    // Call the TimeInterval to logout when the user is inactive.
    //    timerObj.Start();
    //}

    //private void UpdateTimer(Object source, ElapsedEventArgs e)
    //{
    //    InvokeAsync(async () =>
    //    {
    //        // Log out when the user is inactive.
    //        var user = (await _AutService.GetAuthenticationStateAsync()).User;
    //        if (!user.Identity.IsAuthenticated)

    //            if (user.Identity.IsAuthenticated)
    //            {
    //                /* Your session is about to timeout in 5 minutes and 0 seconds */
    //                /* Do you wish to stay connected */
    //                /* Yes No (Logout)*/
    //                /* If no response redirect to page session timeout*/
    //                await _authInterfaceService.Logout();
    //            }
    //    });
    //}

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        /*Jbox Scripts*/
        var modernizr = "/Scripts/jbox/vendor/modernizr-3.6.0.min.js";
        await _js.InvokeVoidAsync("loadJs", modernizr);

        var jquery360 = "/Scripts/jbox/vendor/jquery-3.6.0.min.js";
        await _js.InvokeVoidAsync("loadJs", jquery360);

        var jmigrate = "/Scripts/jbox/vendor/jquery-migrate-3.3.0.min.js";
        await _js.InvokeVoidAsync("loadJs", jmigrate);

        var bootbundle = "/Scripts/jbox/vendor/bootstrap.bundle.min.js";
        await _js.InvokeVoidAsync("loadJs", bootbundle);

        var waypoints = "/Scripts/jbox/plugins/waypoints.js";
        await _js.InvokeVoidAsync("loadJs", waypoints);

        var magnificpopup = "/Scripts/jbox/plugins/magnific-popup.js";
        await _js.InvokeVoidAsync("loadJs", magnificpopup);

        var perscrollbar = "/Scripts/jbox/plugins/perfect-scrollbar.min.js";
        await _js.InvokeVoidAsync("loadJs", perscrollbar);

        var select2jb = "/Scripts/jbox/plugins/select2.min.js";
        await _js.InvokeVoidAsync("loadJs", select2jb);

        var swiperbundle = "/Scripts/jbox/plugins/swiper-bundle.min.js";
        await _js.InvokeVoidAsync("loadJs", swiperbundle);

        var jqcircliful = "/Scripts/jbox/plugins/jquery.circliful.js";
        await _js.InvokeVoidAsync("loadJs", jqcircliful);

        var indexcharts = "/Scripts/jbox/plugins/charts/index.js";
        await _js.InvokeVoidAsync("loadJs", indexcharts);

        var xy = "/Scripts/jbox/plugins/charts/xy.js";
        await _js.InvokeVoidAsync("loadJs", xy);

        var animatedjb = "/Scripts/jbox/plugins/charts/Animated.js";
        await _js.InvokeVoidAsync("loadJs", animatedjb);

        var armcharts5 = "/Scripts/jbox/plugins/armcharts5-script.js";
        await _js.InvokeVoidAsync("loadJs", armcharts5);

        var mainjb = "/Scripts/jbox/main.js";
        await _js.InvokeVoidAsync("loadJs", mainjb);

        /*ArchitectUI Scripts*/
        var wizUrl = "/Scripts/js/jquery.smartWizard.min.js";
        await _js.InvokeVoidAsync("loadJs", wizUrl);

        var formUrl = "/Scripts/js/form-wizard.js";
        await _js.InvokeVoidAsync("loadJs", formUrl);

        var perfectScrollBarUrl = "/Scripts/js/perfect-scrollbar.js";
        await _js.InvokeVoidAsync("loadJs", perfectScrollBarUrl);

        var blockUIrUrl = "/Scripts/js/jquery.blockUI.js";
        await _js.InvokeVoidAsync("loadJs", blockUIrUrl);

        var scrollbarUrl = "/Scripts/js/scrollbar.js";
        await _js.InvokeVoidAsync("loadJs", scrollbarUrl);

        var metisMenuUrl = "/Scripts/js/metisMenu.js";
        await _js.InvokeVoidAsync("loadJs", metisMenuUrl);

        var demoUrl = "/Scripts/js/demo.js";
        await _js.InvokeVoidAsync("loadJs", demoUrl);

        var blockUI2rUrl = "/Scripts/js/blockui.js";
        await _js.InvokeVoidAsync("loadJs", blockUI2rUrl);

        var appUrl = "/Scripts/js/app.js";
        await _js.InvokeVoidAsync("loadJs", appUrl);

        

        

        
    }
}

